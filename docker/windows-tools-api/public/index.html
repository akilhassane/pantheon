<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîí Windows Tools API</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .status-bar {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #dee2e6;
        }
        .status-item {
            text-align: center;
        }
        .status-item .icon {
            font-size: 2em;
            margin-bottom: 5px;
        }
        .status-item .label {
            font-size: 0.9em;
            color: #666;
        }
        .content {
            padding: 40px;
        }
        .section {
            margin-bottom: 40px;
        }
        .section h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        .alert {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .alert.success {
            background: #d4edda;
            border-left-color: #155724;
        }
        .alert.warning {
            background: #fff3cd;
            border-left-color: #856404;
        }
        .alert.danger {
            background: #f8d7da;
            border-left-color: #721c24;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .endpoint {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .endpoint .method {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
        }
        .tool-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .tool-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }
        .tool-card .description {
            color: #666;
            margin-bottom: 15px;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .info-box {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 6px;
            padding: 15px;
        }
        .info-box h4 {
            color: #004085;
            margin-bottom: 10px;
        }
        ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        li {
            margin: 8px 0;
        }
        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #666;
            border-top: 1px solid #dee2e6;
        }
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí Windows Tools API</h1>
            <div class="subtitle">Encrypted Code-as-a-Service (AES-256-GCM)</div>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <div class="icon">‚úì</div>
                <div class="label">Running</div>
            </div>
            <div class="status-item">
                <div class="icon">üîê</div>
                <div class="label">Encrypted</div>
            </div>
            <div class="status-item">
                <div class="icon">‚úì</div>
                <div class="label">Security: High</div>
            </div>
        </div>

        <div class="content">
            <div class="alert success">
                <strong>‚úì Security:</strong> All Python scripts are encrypted with AES-256-GCM before transmission. Scripts are never saved to Windows VM disk - they're decrypted and executed in memory only.
            </div>

            <div class="section">
                <h2>üîë Authentication</h2>
                <p>All API requests require Bearer token authentication with your project's API_SERVICE_KEY:</p>
                <div class="code-block">Authorization: Bearer YOUR_API_SERVICE_KEY</div>
                <div class="alert warning">
                    <strong>Note:</strong> Each project has a unique API service key. Find yours in the project's .env file.
                </div>
            </div>

            <div class="section">
                <h2>üì° API Endpoints</h2>
                
                <div class="endpoint">
                    <span class="method">GET</span>
                    <code>/</code><br>
                    This documentation page
                </div>

                <div class="endpoint">
                    <span class="method">GET</span>
                    <code>/health</code><br>
                    Health check endpoint
                </div>

                <div class="endpoint">
                    <span class="method">GET</span>
                    <code>/api/tools</code><br>
                    List all available tools (requires auth)
                </div>

                <div class="endpoint">
                    <span class="method">POST</span>
                    <code>/api/execute</code><br>
                    Execute a tool (requires auth)
                </div>
            </div>

            <div class="section">
                <h2>üõ†Ô∏è Available Tools (10 Total)</h2>
                <p>All tools return encrypted responses that must be decrypted by the client before execution.</p>

                <div class="tool-card">
                    <h3>1. execute_powershell</h3>
                    <div class="description">Execute PowerShell commands in Windows</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "execute_powershell", "arguments": {"command": "Get-Process | Select-Object -First 5"}}</div>
                </div>

                <div class="tool-card">
                    <h3>2. take_screenshot</h3>
                    <div class="description">Capture screen with OCR analysis, UI elements, and mouse position</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "take_screenshot", "arguments": {}}</div>
                    <strong>After Client Decrypts & Executes:</strong>
                    <div class="code-block">{"success": true, "screenshot": "iVBORw0KGgo...", "ocr_text": "Start Menu\\nSearch...", "ui_elements": [...], "mouse_position": {"x": 640, "y": 360}}</div>
                </div>

                <div class="tool-card">
                    <h3>3. move_mouse</h3>
                    <div class="description">Move mouse cursor to specific coordinates</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "move_mouse", "arguments": {"x": 500, "y": 300}}</div>
                </div>

                <div class="tool-card">
                    <h3>4. click_mouse</h3>
                    <div class="description">Click mouse at specific coordinates</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "click_mouse", "arguments": {"x": 10, "y": 1070, "button": "left", "double": false}}</div>
                </div>

                <div class="tool-card">
                    <h3>5. get_mouse_position</h3>
                    <div class="description">Get current mouse cursor coordinates</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "get_mouse_position", "arguments": {}}</div>
                </div>

                <div class="tool-card">
                    <h3>6. type_text</h3>
                    <div class="description">Type text using keyboard</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "type_text", "arguments": {"text": "Hello, World!", "interval": 0.05}}</div>
                </div>

                <div class="tool-card">
                    <h3>7. press_key</h3>
                    <div class="description">Press keyboard key or key combination</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "press_key", "arguments": {"key": "enter"}}</div>
                    <strong>Common Keys:</strong>
                    <ul>
                        <li><code>enter</code> - Enter key</li>
                        <li><code>esc</code> - Escape key</li>
                        <li><code>tab</code> - Tab key</li>
                        <li><code>win</code> - Windows key</li>
                        <li><code>ctrl+c</code> - Copy</li>
                        <li><code>ctrl+v</code> - Paste</li>
                        <li><code>alt+f4</code> - Close window</li>
                    </ul>
                </div>

                <div class="tool-card">
                    <h3>8. scroll_mouse</h3>
                    <div class="description">Scroll mouse wheel up or down</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "scroll_mouse", "arguments": {"direction": "down", "clicks": 5, "x": 640, "y": 400}}</div>
                </div>

                <div class="tool-card">
                    <h3>9. find_text_on_screen</h3>
                    <div class="description">Search for text on screen using OCR</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "find_text_on_screen", "arguments": {"text": "Start", "partial_match": true}}</div>
                </div>

                <div class="tool-card">
                    <h3>10. send_to_terminal</h3>
                    <div class="description">Send command to PowerShell terminal via WebSocket</div>
                    <strong>Request:</strong>
                    <div class="code-block">{"tool": "send_to_terminal", "arguments": {"command": "Get-Date", "terminal_port": 10033}}</div>
                    <div class="alert">
                        <strong>Note:</strong> The terminal_port is automatically provided by the backend based on the project configuration.
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üìù Complete Example: Open Notepad</h2>
                <p>Here's how an AI would use multiple tools to open Notepad and type text:</p>
                
                <div class="code-block">
<strong>Step 1: Take Screenshot</strong>
POST /api/execute
{"tool": "take_screenshot", "arguments": {}}
// AI sees desktop with Start button

<strong>Step 2: Click Start Button</strong>
POST /api/execute
{"tool": "click_mouse", "arguments": {"x": 10, "y": 1070, "button": "left"}}
// Start menu opens

<strong>Step 3: Type 'notepad'</strong>
POST /api/execute
{"tool": "type_text", "arguments": {"text": "notepad"}}
// "notepad" appears in search

<strong>Step 4: Press Enter</strong>
POST /api/execute
{"tool": "press_key", "arguments": {"key": "enter"}}
// Notepad launches

<strong>Step 5: Type Message</strong>
POST /api/execute
{"tool": "type_text", "arguments": {"text": "Hello World"}}
// "Hello World" appears in Notepad

<strong>Step 6: Verify</strong>
POST /api/execute
{"tool": "take_screenshot", "arguments": {}}
// AI sees "Hello World" in Notepad
                </div>
            </div>

            <div class="section">
                <h2>üîê Security Architecture</h2>
                <div class="alert danger">
                    <strong>‚ö†Ô∏è Important:</strong> All responses are encrypted with AES-256-GCM. The client must decrypt before execution.
                </div>

                <h3>Encryption Flow:</h3>
                <ol>
                    <li>API reads script from secure storage</li>
                    <li>API encrypts with project-specific key</li>
                    <li>API sends encrypted blob + IV + auth tag</li>
                    <li>Client receives encrypted data</li>
                    <li>Client decrypts in memory</li>
                    <li>Client executes (never saves to disk)</li>
                    <li>Client returns results</li>
                    <li>Script discarded from memory</li>
                </ol>

                <h3>What AI Receives:</h3>
                <div class="code-block">{"encrypted": true, "encryptedScript": "unreadable encrypted blob", "iv": "initialization vector", "authTag": "authentication tag", "decryption": {"algorithm": "aes-256-gcm", "key": "project encryption key"}}</div>

                <div class="grid">
                    <div class="info-box">
                        <h4>‚ùå What AI Cannot Do:</h4>
                        <ul>
                            <li>Read the Python script source code</li>
                            <li>See the script logic</li>
                            <li>Modify the scripts</li>
                            <li>Extract scripts from Windows VM</li>
                            <li>Reverse engineer the encryption</li>
                        </ul>
                    </div>
                    <div class="info-box">
                        <h4>‚úÖ What AI Can Do:</h4>
                        <ul>
                            <li>Call any of the 10 tools</li>
                            <li>Receive encrypted responses</li>
                            <li>Get execution results</li>
                            <li>Analyze screenshots and OCR data</li>
                            <li>Control Windows via mouse/keyboard</li>
                            <li>Chain multiple tool calls</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üìä System Information</h2>
                <div class="grid">
                    <div class="info-box">
                        <h4>API Details</h4>
                        <ul>
                            <li>Version: 2.0.0</li>
                            <li>Port: 8090</li>
                            <li>Protocol: HTTP/REST</li>
                            <li>Rate Limit: 100 req/min</li>
                        </ul>
                    </div>
                    <div class="info-box">
                        <h4>Security</h4>
                        <ul>
                            <li>Encryption: AES-256-GCM</li>
                            <li>Key Length: 256 bits</li>
                            <li>Per-Project Keys: Yes</li>
                            <li>Scripts on Disk: No (memory only)</li>
                        </ul>
                    </div>
                    <div class="info-box">
                        <h4>Tools</h4>
                        <ul>
                            <li>Total Tools: 10</li>
                            <li>Python Scripts: 28</li>
                            <li>Script Storage: Encrypted</li>
                            <li>Execution: In-memory</li>
                        </ul>
                    </div>
                    <div class="info-box">
                        <h4>Architecture</h4>
                        <ul>
                            <li>Type: Code-as-a-Service</li>
                            <li>Transmission: Encrypted</li>
                            <li>Client: Thin (no code)</li>
                            <li>Security: High</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <strong>Windows Tools API - Encrypted Code-as-a-Service</strong><br>
            All scripts encrypted with AES-256-GCM | Per-project encryption keys | Scripts never saved to disk<br>
            Port: 8090 | Status: Running | Security: High | Encryption: Enabled
        </div>
    </div>
</body>
</html>
